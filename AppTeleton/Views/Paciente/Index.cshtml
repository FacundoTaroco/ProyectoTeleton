@model AppTeleton.Models.PacienteIndexViewModel;
@{
    ViewData["Title"] = "Index";
}
@{
    if (ViewBag.Mensaje != null)
    {
        if (ViewBag.TipoMensaje == "ERROR")
        {
                                    <div class="alert alert-danger" role="alert">@ViewBag.Mensaje</div>
        }
        else if (ViewBag.TipoMensaje == "EXITO")
        {
                                    <div class="alert alert-success" role="alert">@ViewBag.Mensaje</div>
        }

    }
}

<form id="formularioAbrirNotificaciones" asp-controller="Paciente" asp-action="NotificacionesPaciente" style="display:none;" method="get">


</form>


<h1>Index</h1>

@if(Model.Notificacion != null){
    <p>Notificacion mas reciente</p>
    <div id="divNotificacionMasReciente" class="container alert alert-dark" role="alert">
        <div class="row">
            <p class="col-8">@Model.Notificacion.Titulo</p>
            <p class="col-4">@Model.Notificacion.fecha</p>
            <p class="col-12">@Model.Notificacion.Mensaje</p>
        </div>
    </div>
}
else
{

    <div id="divNotificacionMasReciente" style="display:none;">
    </div>
}
<div id="notificationBlock" class="alert alert-info" role="alert">
    Active las notificaciones para recibir avisos y recordatorios importantes
    <button class="btn btn-primary" onclick="suscribirse()">Aceptar</button>
    <button class="btn btn-secondary" onclick="hideNotificationBlock()">No ahora</button>
</div>


<h1>Hello, world!</h1>
<h2>The time on the server is @DateTime.Now</h2>

<form id="subscriptionForm" asp-controller="Notificacion" asp-action="GuardarDispositivoNotificacion" method="post" style="display: none;">
    <input type="text" id="endpoint" name="pushEndpoint">
    <input type="text" id="p256dh" name="pushP256DH">
    <input type="text" id="auth" name="pushAuth">
</form>


<script>
    
     document.addEventListener("DOMContentLoaded", function () { verSiEsconderMensajeNotificacion() });
 
    document.querySelector("#divNotificacionMasReciente").addEventListener("click", function (e) {
      
        let form = document.querySelector("#formularioAbrirNotificaciones")
        form.submit();
    })
</script>

